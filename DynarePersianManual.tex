\documentclass[12pt]{article} 
\usepackage[margin=2cm]{geometry} 
\usepackage{psfrag} 
\usepackage{graphicx} 
\usepackage{pgfplots} 
\pgfplotsset{compat=newest} 
\usetikzlibrary{plotmarks} 
\usetikzlibrary{arrows.meta} 
\usepgfplotslibrary{patchplots} 
\usepackage{grffile} 
\usepackage{url}  
\usepackage{epstopdf} 
\usepackage{longtable,booktabs} 
\usepackage{amsmath,amsfonts} 
\usepackage{breqn} 
\usepackage{authblk}
\usepackage{float,morefloats,caption} 
\usepackage[framed,numbered,autolinebreaks,useliterate]{mcode}
\usepackage{xepersian} 
\settextfont{XB Zar} 
\setlatintextfont{Times New Roman} 
\setdigitfont{Yas} 
\title{پارسی‌ساز نرم‌افزار Dynare}
\author{حسین توکلیان\thanks{tavakolianh@gmail.com} }%\date{}
\affil{عضو هیئت علمی دانشکده اقتصاد دانشگاه علامه طباطبائی}
\begin{document} 
\maketitle

\section{مقدمه}
با توجه به این‌که نرم‌افزار Dynare در فضای نرم‌افزار MATLAB استفاده شده و بسیاری از کاربران از آن برای کارهای تحقیقاتی خود استفاده می‌کنند و نیاز به تبدیل خروجی‌های این نرم‌افزار به پارسی دارند، تغییرات ارائه شده در این بسته این نیاز را برطرف می‌سازد. برای این‌که بتوان از این بسته به‌درستی استفاده کرد به تغییراتی در سیستم عامل وجود دارد که در ادامه به این تغییرات اشاره خواهد شد. قبل از آن باید نرم‌افزارهای دیگری که مکمل این بسته هستند نیز باید معرفی گردد. این بسته قابل استفاده در دو سیستم عامل ویندوز و مک است. 
\section{نرم‌افزارهای مورد نیاز}
با توجه به این‌که Dynare به راحتی خروجی‌ها را به‌صورت لاتک ارائه می‌کند، اولین نرم‌افزاری که کاربر باید در دستگاه خود نصب کند نرم‌افزار ‪\LaTeX‬‬ است. با توجه به این‌که این نرم‌افزار یک نرم‌افزار ‪\lr{Open Source}‬‬‬ است، ممکن است کاربر با نسخه‌های مختلفی از آن روبرو شود. بنابراین در این‌جا توصیه اکید می‌شود از نرم‌افزار Protext استفاده شود که از لینک ‪\lr{\url{https://www.tug.org/protext/}}‬‬‬ نرم‌افزار ‪\lr{MiKTeX}‬‬ برای ویندوز و از لینک ‪\lr{\url{http://www.tug.org/mactex/}}‬‬‬ نرم‌افزار ‪\lr{MacTeX}‬‬‬ را برای مک دانلود کنند. برای استفاده از ‪\lr{Editor}‬‬‬ مناسب برای سیستم عامل ویندوز، در لینک مربوط به ویندوز و به همراه ‪\lr{MiKTeX}‬‬ ‬‬ نرم‌افزار ‪\lr{TeXstudio}‬‬ ‬‬‪  نیز وجود دارد که سازگار با نیم‌فاصله در کیبورد استاندارد پارسی است. در مورد سیستم عامل مک، هر ‪\lr{Editor}‬‬ ‬‬‬مد نظر کاربر با کلیه ویژگی‌های کیبورد استاندارد پارسی هم‌خوانی دارد اما نویسنده نرم‌افزار ‪\lr{TeXmaker}‬‬ ‬‬‬را توصیه می‌کند که از لینک ‪\lr{\url{http://www.xm1math.net/texmaker/}}‬‬‬ قابل دانلود است.

برای این‌که اصول نگارش پارسی به‌درستی رعایت شود، اکیداً توصیه می‌شود که فونت‌های سری ‪\lr{XB}‬‬ دانلود و در سیستم‌ عامل نصب شود چرا که فونت‌های سری ‪\lr{B}‬‬ دارای مشکلاتی است که بسیاری از اصول نگارش پارسی مانند تفاوت عدد ۵ در پارسی و عربی یا تفاوت حرف ی و ي را رعایت نمی‌کند. با جست‌وجوی ساده‌ای می‌توان فونت‌های سری ‪\lr{XB}‬‬ از سایت‌های مختلف دانلود کرد. بسته DynarePersian از فونت ‪\lr{XB Zar}‬‬‬ برای متن پارسی استفاده می‌کند. بنابراین اگر کاربر این فونت را در سیستم عامل خود نداشته باشد، قادر به دریافت خروجی پارسی نخواهد بود مگر این‌که در فایل‌های خروجی ‪\LaTeX‬‬‬ فونت را تغییر دهد. همچنین برای این‌که صفر پارسی که توخالی است (‪$0$‬‬‬‬) رعایت شود، حتماً باید فونت Yas در سیستم عامل نصب باشد. این فونت، فونت اعداد در بسته حاضر است. این دو فونت کلیدی در بسته ارائه شده وجود دارد.

آخرین جعبه‌ابزاری که قبل از استفاده از DynarePersian باید در سیستم عامل وجود داشته باشد جعبه‌ابزار بسیار قوی matlab2tikz است. tikz بسته‌ای است در ‪\LaTeX‬‬ که به کاربر امکان رسم اشکال با کیفیت و دقت بسیار بالا را مهیا می‌سازد. جعبه‌ابزار فوق جعبه‌ابزاری است که نمودارهای MATLAB را به tikz تبدیل می‌کند. دلیل این‌که از این جعبه‌ابزار در DynarePersian استفاده شده این است که کیفیت نمودارها با استفاده از این جعبه‌ابزار بسیار بالا خواهد بود اما مهمتر از آن این است که با استفاده از این ابزار اعداد نمودارها پارسی شده و امکان لحاظ نمادهای مختلف مانند حروف یونانی در نمودارها نیز مهیا خواهد شد. این جعبه ابزار را می‌توان از لینک ‪\lr{\url{https://github.com/matlab2tikz/matlab2tikz}}‬‬‬‬ دانلود کرد. پس از دانلود و unzip کردن آن در یکی از درایوهای دستگاه خود همانند Dynare باید مسیر آن را از طریق گزینه ‪\lr{Set Path}‬‬‬‬‬ نرم‌افزار MATLAB تنظیم کرد تا MATLAB بتواند از آن استفاده کند. ‪
\section{تنظیمات نرم‌افزار MATLAB در سیستم عامل مک}
اولین تنظیماتی که باید در نرم‌افزار MATLAB اعمال کرد، تغییر ‪encodin‬‬ آن است تا کاراکترهای پارسی را بپذیرد. با توجه به اینکه تا نسخه ‪\lr{R2017a}‬‬‬‬‬ نرم‌افزار MATLAB نیاز به تغییراتی اساسی در راستای پذیرش زبان پارسی و ‪\lr{UTF8 Encoding}‬‬‬ دارد، کلیه مطالب حاضر برای نسخه ‪\lr{MATLAB R2017b}‬‬‬ به بعد قابل اجراست و تضمینی برای اجرا در نسخه‌های قبلی وجود ندارد. در مورد سیستم عامل مک با فرض این‌که کاربر زبان پارسی  و کیبورد استاندارد پارسی را در سیستم عامل به‌عنوان یکی از ‪\lr{Input Source}‬‬‬ها در بخش ‪\lr{System Preference/ Language \& Region/ Keyboard Preference}‬‬‬ اضافه کرده باشد، تنظیمات به راحتی به‌راحتی قابل انجام خواهد بود. برای این کار کافی است که در ‪\lr{Command Window}‬‬‬ دستور زیر اجرا شود:
\begin{latin}
\begin{lstlisting}[basicstyle=\scriptsize]
feature('DefaultCharacterSet', 'UTF-8')
ans =
    'UTF-8'
\end{lstlisting}
\end{latin}
برای اطمینان از این‌که تغییر تنظیمات در نرم‌افزار اعمال شده است، دستور زیر را در ‪\lr{Command Window}‬‬‬  اجرا می‌کنیم:
 \begin{latin}
\begin{lstlisting}[basicstyle=\scriptsize]
feature('locale')
ans = 
  struct with fields:

               ctype: 'en_US_POSIX.UTF-8'
             collate: 'en_US_POSIX.UTF-8'
                time: 'en_US_POSIX.UTF-8'
             numeric: 'en_US_POSIX.UTF-8'
            monetary: 'en_US_POSIX.UTF-8'
            messages: 'en_US.UTF-8'
            encoding: 'UTF-8'
    terminalEncoding: 'UTF-8'
         jvmEncoding: 'UTF-8'
              status: 'MathWorks locale management system initialized.'
             warning: 'Invalid locale name.'
\end{lstlisting}
\end{latin}
مهمترین ‪\lr{Encoding}‬‬‬ که باید تغییر یافته باشد،  ‪\lr{jvmEncoding}‬‬‬ است که مربوط به جاواست و حتما باید ‪\lr{'UTF-8'}‬‬‬‬ باشد چرا که به شما این امکان را می‌دهد تا در ‪\lr{Editor}‬‬ نرم‌افزار از کاراکترهای پارسی استفاده کنید و در ‪\lr{Command Window}‬‬‬   کاراکترهای پارسی نمایش داده شود.  در مورد سیستم عامل مک به همین راحتی نرم‌افزار آماده بهره‌برداری از فایل‌های پارسی می‌شود. این نکته مستقل از نرم‌افزار Dynare است و در مورد کل MATLAB قابل اجراست و شما می‌توانید فایل‌های با نام پارسی و دارای محتوای پارسی را هم فراخوانی کنید و خروجی‌های پارسی مانند ماتریس پارسی را هم در نویسه‌های مختلف داشته باشید.

\section{تنظیمات نرم‌افزار MATLAB در سیستم عامل ویندوز}
متأسفانه تنظیمات لازم برای پارسی‌سازی MATLAB در سیستم عامل ویندوز به راحتی مک نیست. دلیل آن هم این است که با وجود این‌که دستور مورد اشاره در تنظیمات مک باید در MATLAB تحت ویندوز نیز اجرا شود اما به‌راحتی ‪Encoding‬‬‬ جاوا را به ‪UTF8 تبدیل نمی‌کند. با اجرای دستور زیر داریم:
\begin{latin}
\begin{lstlisting}[basicstyle=\scriptsize]
feature('DefaultCharacterSet', 'UTF-8')
ans =
    'UTF-8'
\end{lstlisting}
\end{latin}
اما با اجرای دستور زیر:
\begin{latin}
\begin{lstlisting}[basicstyle=\scriptsize]
feature('locale')
ans = 
  struct with fields:

               ctype: 'en_US.windows-1252'
             collate: 'en_US.windows-1252'
                time: 'en_US.windows-1252'
             numeric: 'en_US_POSIX.windows-1252'
            monetary: 'en_US.windows-1252'
            messages: 'en_US.windows-1252'
            encoding: 'windows-1252'
    terminalEncoding: 'IBM437'
         jvmEncoding: 'Cp1252'
              status: 'MathWorks locale management system initialized.'
             warning: ''
\end{lstlisting}
\end{latin}
مشاهده می‌شود که کماکان ‪\lr{jvmEncoding: 'Cp1252'}‬‬‬‬. برای این‌که بتوان تنظیمات را اعمال کرد باید به مسیر ‪\lr{C:\textbackslash Program Files\textbackslash MATLAB\textbackslash R2018b\textbackslash bin}‬‬‬ مراجعه کرده و فایل ‪\lr{lcdata.xml}‬‬ و ‪\lr{lcdata\_utf8.xml}‬‬‬‬ را پیدا کنید (به پسوند‌ها دقت بفرمایید چون فایلی به همین نام اما پسوند xsd هم وجود دارد که با آن کاری نداریم). نام این دو فایل را تغییر می‌دهیم مثلاً  آن‌ها را به  ‪\lr{lcdata1.xml}‬‬ و ‪\lr{lcdata\_utf81.xml}‬ تغییر می‌دهیم و ‬‬‬فایل ‪\lr{lcdata.xml}‬‬ ‬موجود در بستهٔ DynarePersian را در همین پوشه ‪\lr{Copy\& Paste}‬‬‬ می‌کنیم. برای ایجاد اطمینان ‪\underline{دوبار}‬‬‬ دستور زیر را در ‪\lr{Command Window}‬‬ اجرا می‌کنیم. دقت داشته باشید که اگر MATLAB در حین انجام این تغییرات باز بوده حتما قبل از اجرای دستور زیر یک بار آن را ببندید و دوباره آن را باز کنید:
\begin{latin}
\begin{lstlisting}[basicstyle=\scriptsize]
feature('DefaultCharacterSet', 'UTF-8')
ans =
    'UTF-8'
\end{lstlisting}
\end{latin}
پس از آن با اجرای دستور زیر خروجی باید چنین باشد:
  \begin{latin}
\begin{lstlisting}[basicstyle=\scriptsize]
feature('locale')
ans = 
  struct with fields:

               ctype: 'en_US.windows-1252'
             collate: 'en_US.windows-1252'
                time: 'en_US.windows-1252'
             numeric: 'en_US_POSIX.windows-1252'
            monetary: 'en_US.windows-1252'
            messages: 'en_US.windows-1252'
            encoding: 'windows-1252'
    terminalEncoding: 'IBM437'
         jvmEncoding: 'UTF-8'
              status: 'MathWorks locale management system initialized.'
             warning: ''
\end{lstlisting}
\end{latin}
یعنی  ‪\lr{jvmEncoding: 'UTF-8'}‬‬‬‬ شده است. با این کار MATLAB در ویندوز آماده بهره‌برداری از زبان پارسی است.
\section{نحوه استفاده از DynarePersian}
تغیییرات اصلی که در نسخه اولیه در نرم‌افزار Dynare در راستای پارسی سازی انجام شده شامل تغییراتی است که در فایل‌های ‪\lr{write\_latex\_parameter\_table.m}‬‬، ‪\lr{write\_latex\_parameter\_definitions.m}‬‬، ‪\lr{write\_latex\_definitions.m}‬‬‬‬‬ و ‪\lr{write\_latex\_parameter\_files.m}‬‬ انجام شده که همگی با همین نام‌ها اما با پسوند ‪\lr{\_persian}‬‬ در بستهٔ DynarePersian موجود هستند. بنابراین کاربر کافی است به جای این دستورها در فایل ‪\lr{mod}‬ خود از معادل با پسوند ‬‪\lr{\_persian}‬‬ ‬‬ استفاده کند. علاوه بر این فایل‌ها، مهمترین فایل‌هایی که تغییر یافته‌اند، فایل‌های ‪\lr{stoch\_simul.m}‬‬، ‪\lr{disp\_moments.m}‬‬ و ‪\lr{dyn\_latex\_table.m}‬‬‬ است که پارسی‌سازی شده و قابلیت دریافت خروجی tikz را هم دارند. باید دقت داشت که این فایل‌ها باید در کنار فایل ‪mod‬‬ در یک پوشه باشند مگر نه قابلیت استفاده از آن‌ها وجود نخواهد داشت. نکته دیگر آن‌که به دلیل مشکلی که بستهٔ ‪XeLaTeX‬‬‬ با تبدیل فایل‌های تصویری با پسوند eps به فایل‌های pdf دارد، در نسخه اولیه بهتر است در دستور ‪\lr{stoch\_simul}‬‬‬ در نویسه مدل حتماً از دستور ‪\lr{graph\_format=(pdf,eps)}‬‬‬‬  استفاده شود که نرم‌افزار هر دو خروجی را به‌صورت همزمان تولید کند. نمونه‌ای از فایل ‪mod‬‬‬ که پارسی‌سازی شده در بسته با نام ‪\lr{New\_keynesian.mod}‬‬ آورده شده است. دقت داشته باشید که بعد از دستور ‪\lr{stoch\_simul}‬‬‬ چند خط اضافی وجود دارد که به شما این امکان را می‌دهد که بدون نیاز به استفاده از ‪Editor‬‬های ‪\LaTeX‬‬‬‬ با استفاده از MATLAB نرم‌افزار  ‪\LaTeX‬‬‬‬ را اجرا کرده و خروجی pdf را دریافت کنید. با توجه به مشکلی که در مورد فایل‌های eps اشاره شد، برای این‌که خروجی pdf نمودارهای IRF را نیز ارائه دهد باید دو بار دستور زیر اجرا شود:
 \begin{latin}
\begin{lstlisting}[basicstyle=\scriptsize]
dynare New_keynesian
\end{lstlisting}
\end{latin}
با وجود این‌که می‌توان با استفاده از MATLAB  خروجی pdf و پارسی شدهٔ الگو را دریافت کرد اما اکیداً توصیه می‌شود که خروجی ‪‪\lr{New\_keynesian\_TeX\_binder.tex}‬‬‬‬ در یکی از ‪Editor‬‬‬های ‪\LaTeX‪‬‬‬ مانند TeXmaker دوبار اجرا شود. نهایتاً این‌که فرمول‌های تولید شده توسط Dynare در فایل  ‪\lr{New\_keynesian\_dynamic\_content.tex}‬‬‬‬ ‬‬‬به‌صورت dmath است که با جایگذاری equation به جای آن خروجی فرمول‌ها با زبان پارسی هم‌خوانی بسیار بیشتری خواهد داشت.


\end{document}